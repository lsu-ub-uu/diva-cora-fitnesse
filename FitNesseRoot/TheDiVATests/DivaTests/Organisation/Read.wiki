---
Test
---
!contents -R2 -g -p -f -h
!1 Läsa och Lista organisation
!2 Läsa
Det skall gå att lista och läsa organisationer via REST API:et.

!***> Läs organisation:1 i  JSON format

Läser och kontrollerar att JSON är korrekt för att bla. se att domain är rätt uppläst ur databasen.

!| RecordEndpointFixture |
| authToken | type | id | testReadRecord? | getStatusType? |
| $adminAuthToken | divaOrganisation | 1 | {"record":{"data":{"children":[{"children":[{"name":"id","value":"1"},{"children":[{"name":"linkedRecordType","value":"recordType"},{"name":"linkedRecordId","value":"divaOrganisation"}],"name":"type"},{"children":[{"name":"linkedRecordType","value":"system"},{"name":"linkedRecordId","value":"diva"}],"name":"dataDivider"},{"children":[{"name":"linkedRecordType","value":"coraUser"},{"name":"linkedRecordId","value":"coraUser:4412982402853626"}],"name":"createdBy"},{"name":"tsCreated","value":"2017-01-01T00:00:00.000000Z"},{"repeatId":"0","children":[{"children":[{"name":"linkedRecordType","value":"coraUser"},{"name":"linkedRecordId","value":"coraUser:4412982402853626"}],"name":"updatedBy"},{"name":"tsUpdated","value":"2017-01-01T00:00:00.000000Z"}],"name":"updated"}],"name":"recordInfo"},{"name":"domain","value":"test"},{"children":[{"name":"organisationName","value":"Uppsala universitet"},{"name":"language","value":"sv"}],"name":"name"},{"children":[{"name":"language","value":"en"},{"name":"organisationName","value":"Uppsala University"}],"name":"alternativeName"},{"name":"organisationType","value":"university"},{"name":"eligible","value":"no"},{"name":"organisationNumber","value":"202100-2932"}],"name":"organisation"},"actionLinks":{"read":{"requestMethod":"GET","rel":"read","url":"${systemUnderTestUrl}rest/record/divaOrganisation/1","accept":"application/vnd.uub.record+json"},"update":{"requestMethod":"POST","rel":"update","contentType":"application/vnd.uub.record+json","url":"${systemUnderTestUrl}rest/record/divaOrganisation/1","accept":"application/vnd.uub.record+json"},"index":{"requestMethod":"POST","rel":"index","body":{"children":[{"children":[{"name":"linkedRecordType","value":"recordType"},{"name":"linkedRecordId","value":"divaOrganisation"}],"name":"recordType"},{"name":"recordId","value":"1"},{"name":"type","value":"index"}],"name":"workOrder"},"contentType":"application/vnd.uub.record+json","url":"${systemUnderTestUrl}rest/record/workOrder/","accept":"application/vnd.uub.record+json"},"delete":{"requestMethod":"DELETE","rel":"delete","url":"${systemUnderTestUrl}rest/record/divaOrganisation/1"}}}} | OK |

*!
!***> Kontrollera att det går att läsa organisation som saknar alternativt namn

!| RecordEndpointFixture |
| authToken | type | id | testReadRecord? | getStatusType? |
| $adminAuthToken | divaOrganisation | 1452 | | OK |

*!
!2 Lista
"Admin" användare skall kunna lista organisationer. (Ersätts av Systemadmin test???)

!***> Lista organisationer inloggad som "admin" användare

!| RecordEndpointFixture |
| authToken | type | testReadRecordList? | getStatusType? |
| $adminAuthToken | divaOrganisation | | OK |

*!
Ej inloggade användare skall ej få lista organisationer, därför förväntar sig testet FORBIDDEN om en ej inloggad användare försöker lista organisationer.

!***> Lista organisationer utan att vara inloggad (guestUser)

!| RecordEndpointFixture |
| authToken | type | testReadRecordList? | getStatusType? |
| | divaOrganisation | | FORBIDDEN |

*!
!2 DiVA Roler
!3 !-SystemAdmin-!
 * '''Fall1:''' !-SystemAdmin ska kunna läsa en organisation från alla domän.-!
 * '''Fall2:''' !-SystemAdmin ska kunna lista organisationer-!

!***> '''Fall1'''

Vi läser ett organisation från Uppsalas Domän

!| RecordEndpointFixture |
| authToken | type | id | testReadRecord? | getStatusType? |
| $systemAdminAuthToken | divaOrganisation | 1750 | | OK |

Vi läser ett organisation från VTI Domän

!| RecordEndpointFixture |
| authToken | type | id | testReadRecord? | getStatusType? |
| $systemAdminAuthToken | divaOrganisation | 1350 | | OK |

*!
!***> '''Fall2'''

!| RecordEndpointFixture |
| authToken | type | testReadRecordList? | getStatusType? |
| $systemAdminAuthToken | divaOrganisation | | OK |

*!
!3 !-DomainAdmin-!
 * '''Fall1:''' !-DomainAdmin ska kunna läsa en organisation, oavsett vilken domän den är knuten till.-!
 * '''Fall2:''' !-DomainAdmin ska inte kunna lista organisationer-!

!***> '''Fall1''' (AVSTÄNGT)

Vi läser ett organisation från Uppsalas Domän

!| comment |
| RecordEndpointFixture |
| authToken | type | id | testReadRecord? | getStatusType? |
| $domainAdminUUAuthToken | divaOrganisation | 1750 | | OK |

Vi läser ett organisation från VTI Domän

!| comment |
| RecordEndpointFixture |
| authToken | type | id | testReadRecord? | getStatusType? |
| $domainAdminUUAuthToken | divaOrganisation | 1350 | | OK |

*!
!***> '''Fall2''' (AVSTÄNGT)

!| comment |
| RecordEndpointFixture |
| authToken | type | testReadRecordList? | getStatusType? |
| $domainAdminUUAuthToken | divaOrganisation | | FORBIDDEN |

*!
!3 Guest
 * '''Fall1:''' Guest ska kunna läsa en organisation, oavsett vilken domän den är knuten till.
 * '''Fall2:''' Guest ska inte kunna lista organisationer

!***> '''Fall1''' (AVSTÄNGT)

Vi läser ett organisation från Uppsalas Domän

!| comment |
| RecordEndpointFixture |
| authToken | type | id | testReadRecord? | getStatusType? |
| $guestToken | divaOrganisation | 1750 | | OK |

Vi läser ett organisation från VTI Domän

!| comment |
| RecordEndpointFixture |
| authToken | type | id | testReadRecord? | getStatusType? |
| $guestToken | divaOrganisation | 1350 | | OK |

*!
!***> '''Fall2'''

!| RecordEndpointFixture |
| authToken | type | testReadRecordList? | getStatusType? |
| $guestToken | divaOrganisation | | FORBIDDEN |

*!
