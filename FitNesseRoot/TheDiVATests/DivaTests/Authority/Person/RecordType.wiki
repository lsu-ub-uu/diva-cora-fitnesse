---
Static
---
!2 Metadata
!3 Fält och begränsningar:
!style_red[en inloggad användare skall kunna uppdatera "sin egen" personpost, men med begränsningar, dessa är ännu inte inlagda ]
Det som står listat här är nameInData.

!4 Person
 * person (group)
   * recordInfo (group, 1-1, '''noRestrictions''')
     * id (textVar, 1-1, '''write ''')
     * type (link, 1-1, '''write ''')
     * createdBy (link, 1-1, '''readWrite ''')
     * dataDivider (link, 1-1, '''write ''')
     * tsCreated (textVar, 1-1, '''write ''')
     * updated(group, 1-X, '''readwrite''')
     * public (colVar, 1-1, '''readWrite ''')
     * domain (domain, 0-X, '''readWrite''')
   * authorisedName (textVar, 1-1, '''noRestrictions''')
     * firstName(textVar, 0-1,'''noRestrictions''')
   * lastName(textVar, 0-1,'''noRestrictions''')
 * academicTitle (textVar, 0-1, '''readWrite''')
 * yearOfBirth (textVar, 0-1, '''readWrite''')
 * yearOfDeath (textVar, 0-1, '''readWrite''')
 * emailAddress (textVar, 0-1, '''readWrite''')
 * alternativeName (group, 0-X, '''readWrite''')
   * givenName (textVar, 0-1, '''noRestrictions ''')
   * familyName (textVar, 0-1, '''noRestrictions ''')
 * externalURL (group, 0-X, '''readWrite''')
   * linkTitle (textVar, 1-1, '''noRestrictions ''')
   * URL (textVar, 1-1, '''noRestrictions ''')
 * otherAffiliation (group, 0-X, '''readWrite''')
   * affiliation (textVar, 1-1, '''noRestrictions ''')
   * affiliationFromYear (textVar, 0-1, '''noRestrictions ''')
   * affiliationUntilYear (textVar, 0-1, '''noRestrictions ''')
 * ORCID_ID (textVar, 0-X, '''readWrite''')
 * VIAF_ID (textVar, 0-X, '''readWrite''')
 * Libris_ID(textVar, 0-X, '''readWrite''')
 * biographyEnglish (group, 0-1, '''readWrite''')
   * language (colVar, 1-1, '''noRestrictions ''')
   * biography (textVar, 1-1, '''noRestrictions ''')
 * biographySwedish (group, 0-1, '''readWrite''')
   * language (colVar, 1-1, '''noRestrictions ''')
   * biography (textVar, 1-1, '''noRestrictions ''')
 * personDomainPart (group , 0-X, '''readWrite''')

!4 !-PersonDomainPart-!
 * personDomainPart(group)
   * recordInfo (group, 1-1, '''noRestrictions''')
     * id (textVar, 1-1, '''write ''')
     * type (link, 1-1, '''write ''')
     * createdBy (link, 1-1, '''readWrite ''')
     * dataDivider (link, 1-1, '''write ''')
     * tsCreated (textVar, 1-1, '''write ''')
     * updated(group, 1-X, '''readWrite''')
     * public (colVar, 1-1, '''readWrite ''')
     * domain (domain, 1-1, '''readWrite''')
   * identifier(textVar, 0-1, '''readWrite''')
   * affiliation(group, 0-X, '''noRestrictions''')
     * organisationLink (recordLink, 1-1, '''noRestrictions ''')
     * affiliationFromYear (textVar, 0-1, '''noRestrictions ''')
     * affiliationUntilYear (textVar, 0-1, '''noRestrictions ''')


   identifier och affiliation får inte båda vara 0.

!3 !-RecordType-!
!***> Person

!***> Läs posttyp Person

!| RecordEndpointFixture |
| authToken | type | id | testReadRecord? | getStatusType? |
| $adminAuthToken | recordType | person | | OK |

*!
Läs topnivå metadatagruppen för en '''ny''' person, och kontrollera att den har rätt barn

!***> Kontrollera barnen till  personNewGroup

Läs in metadatagruppen för senare kontroll

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personNewGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 15 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataGroup | recordInfoDivaAutogeneratedNewGroup | 1 | 1 | recordInfo | noRestrictions |
| $adminAuthToken | metadataGroup | personNameGroup | 1 | 1 | authorisedName | noRestrictions |
| $adminAuthToken | metadataTextVariable | personAcademicTitleTextVar | 0 | 1 | academicTitle | readWrite |
| $adminAuthToken | metadataTextVariable | yearOfBirthTextVar | 0 | 1 | yearOfBirth | readWrite |
| $adminAuthToken | metadataTextVariable | yearOfDeathTextVar | 0 | 1 | yearOfDeath | readWrite |
| $adminAuthToken | metadataTextVariable | personEmailTextVar | 0 | 1 | emailAddress | readWrite |
| $adminAuthToken | metadataGroup | personAlternativeNameGroup | 0 | X | alternativeName | readWrite |
| $adminAuthToken | metadataGroup | personURLGroup | 0 | X | externalURL | readWrite |
| $adminAuthToken | metadataRecordLink | personDomainPartLink | 0 | X | personDomainPart | readWrite |
| $adminAuthToken | metadataGroup | personOtherAffiliationGroup | 0 | X | otherAffiliation | readWrite |
| $adminAuthToken | metadataTextVariable | personORCIDValueTextVar | 0 | X | ORCID_ID | readWrite |
| $adminAuthToken | metadataTextVariable | personVIAFValueTextVar | 0 | X | VIAF_ID | readWrite |
| $adminAuthToken | metadataTextVariable | personLibrisValueTextVar | 0 | X | Libris_ID | readWrite |
| $adminAuthToken | metadataGroup | personBiographyEnglishGroup | 0 | 1 | biographyEnglish | readWrite |
| $adminAuthToken | metadataGroup | personBiographySwedishGroup | 0 | 1 | biographySwedish | readWrite |

*!
!***> Kontrollera recordInfoDivaAutogeneratedNewGroup

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | recordInfoDivaAutogeneratedNewGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 1 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataRecordLink | dataDividerDivaLink | 1 | 1 | dataDivider | noRestrictions |

*!
Läs topnivå metadatagruppen för en '''befintlig''' person, och kontrollera att den har rätt barn

!***> Kontrollera barnen till personGroup

Läs in metadatagruppen för senare kontroll

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 15 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataGroup | recordInfoPersonDivaGroup | 1 | 1 | recordInfo | noRestrictions |
| $adminAuthToken | metadataGroup | personNameGroup | 1 | 1 | authorisedName | noRestrictions |
| $adminAuthToken | metadataTextVariable | personAcademicTitleTextVar | 0 | 1 | academicTitle | readWrite |
| $adminAuthToken | metadataTextVariable | yearOfBirthTextVar | 0 | 1 | yearOfBirth | readWrite |
| $adminAuthToken | metadataTextVariable | yearOfDeathTextVar | 0 | 1 | yearOfDeath | readWrite |
| $adminAuthToken | metadataTextVariable | personEmailTextVar | 0 | 1 | emailAddress | readWrite |
| $adminAuthToken | metadataGroup | personAlternativeNameGroup | 0 | X | alternativeName | readWrite |
| $adminAuthToken | metadataGroup | personURLGroup | 0 | X | externalURL | readWrite |
| $adminAuthToken | metadataRecordLink | personDomainPartLink | 0 | X | personDomainPart | readWrite |
| $adminAuthToken | metadataGroup | personOtherAffiliationGroup | 0 | X | otherAffiliation | readWrite |
| $adminAuthToken | metadataTextVariable | personORCIDValueTextVar | 0 | X | ORCID_ID | readWrite |
| $adminAuthToken | metadataTextVariable | personVIAFValueTextVar | 0 | X | VIAF_ID | readWrite |
| $adminAuthToken | metadataTextVariable | personLibrisValueTextVar | 0 | X | Libris_ID | readWrite |
| $adminAuthToken | metadataGroup | personBiographyEnglishGroup | 0 | 1 | biographyEnglish | readWrite |
| $adminAuthToken | metadataGroup | personBiographySwedishGroup | 0 | 1 | biographySwedish | readWrite |

*!
Läst in metadatagruppen recordInfoPersonDivaGroup för senare kontroll

!***> Kontrollera recordInfoPersonDivaGroup

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | recordInfoPersonDivaGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 8 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataTextVariable | idTextVar | 1 | 1 | id | write |
| $adminAuthToken | metadataRecordLink | recordTypeLink | 1 | 1 | type | write |
| $adminAuthToken | metadataRecordLink | createdByLink | 1 | 1 | createdBy | readWrite |
| $adminAuthToken | metadataRecordLink | dataDividerDivaLink | 1 | 1 | dataDivider | write |
| $adminAuthToken | metadataTextVariable | tsCreatedTextVar | 1 | 1 | tsCreated | write |
| $adminAuthToken | metadataGroup | updatedGroup | 1 | X | updated | readWrite |
| $adminAuthToken | metadataCollectionVariable | personPublicCollectionVar | 1 | 1 | public | readWrite |
| $adminAuthToken | metadataCollectionVariable | domainCollectionVar | 0 | X | domain | readWrite |

*!
!***> Kontrollera updated

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | updatedGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 2 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataRecordLink | updatedByLink | 1 | 1 | updatedBy | noRestrictions |
| $adminAuthToken | metadataTextVariable | tsUpdatedTextVar | 1 | 1 | tsUpdated | noRestrictions |

*!
!***> Kontrollera authorisedName

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personNameGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 2 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataTextVariable | firstNameTextVar | 0 | 1 | givenName | noRestrictions |
| $adminAuthToken | metadataTextVariable | lastNameTextVar | 0 | 1 | familyName | noRestrictions |

*!
!***> Kontrollera alternativeName

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personAlternativeNameGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 2 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataTextVariable | firstNameTextVar | 0 | 1 | givenName | noRestrictions |
| $adminAuthToken | metadataTextVariable | lastNameTextVar | 0 | 1 | familyName | noRestrictions |

*!
!***> Kontrollera externalURL

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personURLGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 2 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataTextVariable | personExternalURLLabelTextVar | 1 | 1 | linkTitle | noRestrictions |
| $adminAuthToken | metadataTextVariable | personExternalURLTextVar | 1 | 1 | URL | noRestrictions |

*!
!***> Kontrollera otherAffiliation

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personOtherAffiliationGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 3 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataTextVariable | personOtherAffiliationTextVar | 1 | 1 | affiliation | noRestrictions |
| $adminAuthToken | metadataTextVariable | personAffiliationFromTextVar | 0 | 1 | affiliationFromYear | noRestrictions |
| $adminAuthToken | metadataTextVariable | personAffiliationUntilTextVar | 0 | 1 | affiliationUntilYear | noRestrictions |

*!
!***> Kontrollera biographyEnglish

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personBiographyEnglishGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 2 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataCollectionVariable | alternativeNameLanguageEnCollectionVar | 1 | 1 | language | noRestrictions |
| $adminAuthToken | metadataTextVariable | personBiographyTextVar | 1 | 1 | biography | noRestrictions |

*!
!***> Kontrollera biographySwedish

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personBiographySwedishGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 2 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataCollectionVariable | nameLanguageSvCollectionVar | 1 | 1 | language | noRestrictions |
| $adminAuthToken | metadataTextVariable | personBiographyTextVar | 1 | 1 | biography | noRestrictions |

*!
*!
!***> !-PersonDomainPart-!

!| RecordEndpointFixture |
| authToken | type | id | testReadRecord? | getStatusType? |
| $adminAuthToken | recordType | personDomainPart | | OK |

Läs topnivå metadatagruppen för en '''ny''' person, och kontrollera att den har rätt barn

!***> Kontrollera barnen till  personDomainPartNewGroup

Läs in metadatagruppen för senare kontroll

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personDomainPartNewGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 3 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataGroup | recordInfoAutogneratedWithDomainNewGroup | 1 | 1 | recordInfo | noRestrictions |
| $adminAuthToken | metadataTextVariable | personLocalValueTextVar | 0 | 1 | identifier | readWrite |
| $adminAuthToken | metadataGroup | personAffiliationGroup | 0 | X | affiliation | noRestrictions |

Kontrollera recordInfo

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | recordInfoAutogneratedWithDomainNewGroup | |

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 3 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataRecordLink | dataDividerDivaLink | 1 | 1 | dataDivider | noRestrictions |
| $adminAuthToken | metadataCollectionVariable | personPublicCollectionVar | 1 | 1 | public | write |
| $adminAuthToken | metadataCollectionVariable | domainCollectionVar | 1 | 1 | domain | noRestrictions |

*!
Läs topnivå metadatagruppen för en '''befintlig''' person, och kontrollera att den har rätt barn

!***> Kontrollera barnen till personDomainPartGroup

Läs in metadatagruppen för senare kontroll

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personDomainPartGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 3 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataGroup | recordInfoWithDomainGroup | 1 | 1 | recordInfo | noRestrictions |
| $adminAuthToken | metadataTextVariable | personLocalValueTextVar | 0 | 1 | identifier | readWrite |
| $adminAuthToken | metadataGroup | personAffiliationGroup | 0 | X | affiliation | noRestrictions |

Kontrollera recordInfo

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | recordInfoWithDomainGroup | |

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 8 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataTextVariable | idTextVar | 1 | 1 | id | write |
| $adminAuthToken | metadataRecordLink | recordTypeLink | 1 | 1 | type | write |
| $adminAuthToken | metadataRecordLink | createdByLink | 1 | 1 | createdBy | readWrite |
| $adminAuthToken | metadataRecordLink | dataDividerDivaLink | 1 | 1 | dataDivider | write |
| $adminAuthToken | metadataTextVariable | tsCreatedTextVar | 1 | 1 | tsCreated | write |
| $adminAuthToken | metadataGroup | updatedGroup | 1 | X | updated | readWrite |
| $adminAuthToken | metadataCollectionVariable | personPublicCollectionVar | 1 | 1 | public | readWrite |
| $adminAuthToken | metadataCollectionVariable | domainCollectionVar | 1 | 1 | domain | readWrite |

*!
!***> Kontrollera affiliation

Läs in

!| RecordEndpointFixture |
| type | id | testReadRecordAndStoreJson? |
| metadataGroup | personAffiliationGroup | |

Kontrollera barnen

!| ChildComparerFixture |
| expectedNumberOfChildren | testCheckNumberOfChildren? |
| 3 | OK |

!| MetadataLinkFixture |
| authToken | linkedRecordType | linkedRecordId | getRepeatMin? | getRepeatMax? | getNameInData? | getRecordPartConstraint? |
| $adminAuthToken | metadataRecordLink | divaOrganisationLink | 1 | 1 | organisationLink | noRestrictions |
| $adminAuthToken | metadataTextVariable | personAffiliationFromTextVar | 0 | 1 | affiliationFromYear | noRestrictions |
| $adminAuthToken | metadataTextVariable | personAffiliationUntilTextVar | 0 | 1 | affiliationUntilYear | noRestrictions |

*!
*!
!3 Roller
Notera att rättigheterna som kontrolleras i det här avsnittet gäller, vilka rättigheter man har på postTypen inte enstaka poster. Rättigheterna för enstaka poster kontrolleras under de olika testerna för rättigheter så som read, update, etc.

!4 !-SystemAdmin-!
!-SystemAdmin har tillgång till validate, list och search för person postTypen-!

!style_red[Validate och batch_index för personpost är inte implementerade än, därför finns de med i expectedPermissionResult ]
!***> Kontrollera de actions systemAdmin får med i recordType för person

!define currentAuthToken {$systemAdminAuthToken}
!define currentRecordType {person}
!define expectedPermissionResult {Action update is missing. Action delete is missing. Action index is missing. Action create is missing. Action validate is missing. Action batch_index is missing.}
!include -seamless .TheDiVATests.DivaTests.checkActionsForRecordType
*!
!4 !-DomainAdmin-!
!-DomainAdmin har tillgång till validate och search för person  postTypen-!

!***> Kontrollera de actions domainAdmin får med i recordType för person

!define currentAuthToken {$domainAdminUUAuthToken}
!define currentRecordType {person}
!define expectedPermissionResult {Action update is missing. Action delete is missing. Action index is missing. Action create is missing. Action validate is missing. Action list is missing. Action batch_index is missing.}
!include -seamless .TheDiVATests.DivaTests.checkActionsForRecordType

*!
!4 !-Guest-!
!-Guest har tillgång till search för person postTypen-!

!***> Kontrollera de actions domainAdmin får med i recordType för person

!define currentAuthToken {$guestToken}
!define currentRecordType {person}
!define expectedPermissionResult {Action update is missing. Action delete is missing. Action index is missing. Action create is missing. Action validate is missing. Action list is missing. Action batch_index is missing.}
!include -seamless .TheDiVATests.DivaTests.checkActionsForRecordType

*!
